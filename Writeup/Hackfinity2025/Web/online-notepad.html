<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Write-up â€“ Online Notepad Service</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #ffffff;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        nav {
            background-color: #333;
            overflow: hidden;
        }
        nav a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }
        nav a:hover {
            background-color: #ddd;
            color: black;
        }
        header {
            background-color: #1f1f1f;
            padding: 20px;
        }
        header h1 {
            margin: 0;
        }
        section {
            padding: 20px;
        }
        footer {
            background-color: #1f1f1f;
            padding: 10px;
            width: 100%;
            bottom: 0;
        }
        pre {
            background-color: #2c2c2c;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            font-size: 16px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

    </style>
</head>
<body>

<header>
    <h1>Write-up â€“ Online Notepad Service</h1>
</header>

<nav>
    <a href="../index.html">Home</a>
    <a href="#about">About Us</a>
    <a href="../../index.html">Write Up</a>
    <a href="#contact">ğŸ† Exploits</a>
    <a href="../../../Membres/index.html">Membres</a>
</nav>

<div class="container">

    <section id="intro">
        <h2>Ã‰noncÃ©</h2>
        <p>Lâ€™Ã©preuve consiste Ã  accÃ©der Ã  des notes stockÃ©es sur un service en ligne, oÃ¹ chaque utilisateur a ses propres notes protÃ©gÃ©es. Nous avons reÃ§u des identifiants :</p>
        <ul>
            <li><strong>Utilisateur :</strong> noel</li>
            <li><strong>Mot de passe :</strong> pass1234</li>
        </ul>
        <p>Lâ€™objectif est de trouver un flag dans les notes, en exploitant une potentielle faiblesse dans lâ€™API REST.</p>
    </section>

    <section id="analyse">
        <h2>Analyse de la cible</h2>
        <p>Lâ€™URL dâ€™accÃ¨s aux notes est :</p>
        <pre>http://10.10.201.131/note.php</pre>
        <p>Lâ€™Ã©noncÃ© mentionne que le service est sÃ©curisÃ© et que chaque utilisateur ne peut voir que ses propres notes. Cependant, la mention dâ€™une API REST et dâ€™un <code>note_id</code> paramÃ©trable (<code>note_id=${i}</code>) suggÃ¨re que les notes peuvent Ãªtre rÃ©cupÃ©rÃ©es en itÃ©rant sur les IDs.</p>
        <p>Notre partenaire a utilisÃ© <code>curl</code> pour tester diffÃ©rentes valeurs de <code>note_id</code>, mais il a remarquÃ© que les requÃªtes tombaient toujours sur la page de login, malgrÃ© lâ€™utilisation dâ€™un cookie stockÃ© dans <code>cookies.txt</code>.</p>
    </section>

    <section id="solution">
        <h2>Tentative dâ€™exploitation via bruteforce</h2>
        <p>Lâ€™idÃ©e initiale Ã©tait de tester tous les <code>note_id</code> possibles en utilisant un script <code>curl</code> :</p>
        <pre>
for i in {0..1000}; do
  curl -L -c cookies.txt "http://10.10.201.131/note.php?note_id=${i}"
done
            </pre>
        <p>Cependant, cela ne fonctionnait pas, car lâ€™authentification semblait poser problÃ¨me.</p>

        <h2>ProblÃ¨me dâ€™authentification</h2>
        <ul>
            <li>Lâ€™Ã©preuve utilise <strong>Basic Authentication</strong>, donc passer simplement les cookies nâ€™Ã©tait pas suffisant.</li>
            <li>En Basic Auth, les identifiants doivent Ãªtre encodÃ©s en <strong>Base64</strong> et envoyÃ©s dans lâ€™en-tÃªte HTTP.</li>
        </ul>

        <h2>Solution</h2>
        <p>Nous avons ajustÃ© notre requÃªte en ajoutant lâ€™en-tÃªte <code>Authorization</code> pour lâ€™authentification HTTP Basic :</p>
        <pre>
for i in {0..1000}; do
  curl -L -H "Authorization: Basic $(echo -n 'noel:pass1234' | base64)" \
       "http://10.10.201.131/note.php?note_id=${i}"
done
            </pre>

        <h3>Explication</h3>
        <ul>
            <li><code>echo -n 'noel:pass1234' | base64</code> encode <code>noel:pass1234</code> en Base64.</li>
            <li><code>Authorization: Basic &lt;token&gt;</code> permet de sâ€™authentifier directement sans cookies.</li>
            <li><code>note_id=${i}</code> permet dâ€™incrÃ©menter les IDs pour tenter dâ€™accÃ©der Ã  toutes les notes.</li>
        </ul>
    </section>

    <section id="resultat">
        <h2>RÃ©sultat</h2>
        <p>AprÃ¨s quelques tests manuels, nous avons trouvÃ© un <code>note_id</code> qui contenait le flag :</p>
        <pre>flag{this_is_the_secret_note_flag}</pre>
    </section>

    <section id="conclusion">
        <h2>Conclusion</h2>
        <p>Lâ€™Ã©preuve Ã©tait une <strong>faiblesse dâ€™autorisation</strong> classique oÃ¹ lâ€™API ne vÃ©rifie pas correctement si lâ€™utilisateur a le droit dâ€™accÃ©der Ã  une note donnÃ©e.</p>
        <ul>
            <li>Une API sÃ©curisÃ©e devrait <strong>lier chaque note Ã  un utilisateur</strong> et <strong>vÃ©rifier lâ€™ID de session</strong> avant dâ€™afficher le contenu.</li>
            <li>Ici, il suffisait de brute-forcer les <code>note_id</code> avec lâ€™authentification correcte pour accÃ©der aux notes dâ€™autres utilisateurs.</li>
        </ul>

        <h3>Moyens dâ€™attÃ©nuation</h3>
        <ul>
            <li>ImplÃ©menter un <strong>contrÃ´le dâ€™accÃ¨s basÃ© sur lâ€™utilisateur</strong>.</li>
            <li>Ã‰viter dâ€™utiliser des IDs incrÃ©mentaux prÃ©visibles pour les notes (UUID recommandÃ©).</li>
            <li>VÃ©rifier que lâ€™utilisateur authentifiÃ© est bien le propriÃ©taire de la note demandÃ©e.</li>
        </ul>
    </section>

    <section id="score">
        <h2>Score obtenu</h2>
        <p>âœ… <strong>Flag trouvÃ© et validÃ© : 20 points</strong></p>
    </section>
<p>Flag by Pepitoo</p>
</div>

<footer>
    <p>&copy; 2025 Write-up â€“ Online Notepad Service</p>
</footer>

</body>
</html>
